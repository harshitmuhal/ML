<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php" />

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>

	<!-- This site is optimized with the Yoast SEO plugin v15.0 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Difference Between Return Sequences and Return States for LSTMs in Keras</title>
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Difference Between Return Sequences and Return States for LSTMs in Keras" />
	<meta property="og:description" content="The Keras deep learning library provides an implementation of the Long Short-Term Memory, or LSTM, recurrent neural network. As part of this implementation, the Keras API provides access to both return sequences and return state. The use and difference between these data can be confusing when designing sophisticated recurrent neural network models, such as the [&hellip;]" />
	<meta property="og:url" content="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/" />
	<meta property="og:site_name" content="Machine Learning Mastery" />
	<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/" />
	<meta property="article:author" content="https://www.facebook.com/MachineLearningMastery/" />
	<meta property="article:published_time" content="2017-10-23T18:00:22+00:00" />
	<meta property="article:modified_time" content="2019-08-14T04:39:23+00:00" />
	<meta property="og:image" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Understand-the-Difference-Between-Return-Sequences-and-Return-States-for-LSTMs-in-Keras.jpg" />
	<meta property="og:image:width" content="640" />
	<meta property="og:image:height" content="480" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#logo","inLanguage":"en-US","url":"https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#logo"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","description":"Making developers awesome at machine learning","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":"https://machinelearningmastery.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#primaryimage","inLanguage":"en-US","url":"https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Understand-the-Difference-Between-Return-Sequences-and-Return-States-for-LSTMs-in-Keras.jpg","width":640,"height":480,"caption":"Understand the Difference Between Return Sequences and Return States for LSTMs in Keras Photo by Adrian Curt Dannemann, some rights reserved."},{"@type":"WebPage","@id":"https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#webpage","url":"https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/","name":"Difference Between Return Sequences and Return States for LSTMs in Keras","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#primaryimage"},"datePublished":"2017-10-23T18:00:22+00:00","dateModified":"2019-08-14T04:39:23+00:00","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/"]}]},{"@type":"Article","@id":"https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#article","isPartOf":{"@id":"https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#webpage"},"author":{"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8"},"headline":"Difference Between Return Sequences and Return States for LSTMs in Keras","datePublished":"2017-10-23T18:00:22+00:00","dateModified":"2019-08-14T04:39:23+00:00","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#webpage"},"commentCount":112,"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#primaryimage"},"articleSection":"Long Short-Term Memory Networks","inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#respond"]}]},{"@type":"Person","@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8","name":"Jason Brownlee","image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/teachthemachine"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery &raquo; Feed" href="https://feeds.feedburner.com/MachineLearningMastery" />
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery &raquo; Comments Feed" href="https://machinelearningmastery.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery &raquo; Difference Between Return Sequences and Return States for LSTMs in Keras Comments Feed" href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.5.1"}};
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='urvanov_syntax_highlighter-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css?ver=2.8.14' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/urvanov-syntax-highlighter/themes/classic/classic.css?ver=2.8.14' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/urvanov-syntax-highlighter/fonts/monaco.css?ver=2.8.14' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/css/dist/block-library/style.min.css?ver=5.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='simple-sitemap-css-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-sitemap/lib/assets/css/simple-sitemap.css?ver=5.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='contact-form-7-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.2.2' type='text/css' media='all' />
<link rel='stylesheet' id='ssb-front-css-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=3.1.1' type='text/css' media='all' />
<link rel='stylesheet' id='ewd-ufaq-style-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=5.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='ewd-ufaq-rrssb-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=5.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='woo-testimonials-css-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=5.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='theme-stylesheet-css'  href='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21' type='text/css' media='all' />
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp' id='jquery-core-js'></script>
<script type='text/javascript' id='urvanov_syntax_highlighter_js-js-extra'>
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.14","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js?ver=2.8.14' id='urvanov_syntax_highlighter_js-js'></script>
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=3.1.1' id='ssb-front-js-js'></script>
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=5.5.1' id='third-party-js'></script>
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2' id='modernizr-js'></script>
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=5.5.1' id='general-js'></script>
<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/" /><link rel="alternate" type="application/json" href="https://machinelearningmastery.com/wp-json/wp/v2/posts/4560" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://machinelearningmastery.com/?p=4560' />
<link rel="alternate" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Freturn-sequences-and-return-states-for-lstms-in-keras%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Freturn-sequences-and-return-states-for-lstms-in-keras%2F&#038;format=xml" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44039733-3"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-44039733-3', { 'optimize_id': 'GTM-MV6J2DK'});
</script>
 <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>

<!-- Open Graph Meta Tags generated by Simple Social Buttons 3.1.1 -->
<meta property="og:title" content="Difference Between Return Sequences and Return States for LSTMs in Keras - Machine Learning Mastery" />
<meta property="og:description" content="The Keras deep learning library provides an implementation of the Long Short-Term Memory, or LSTM, recurrent neural network.

As part of this implementation, the Keras API provides access to both return sequences and return state. The use and difference between these data can be confusing when designing sophisticated recurrent neural network models, such as the encoder-decoder model.

In this tutorial, you will" />
<meta property="og:url" content="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/" />
<meta property="og:site_name" content="Machine Learning Mastery" />
<meta property="og:image" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Understand-the-Difference-Between-Return-Sequences-and-Return-States-for-LSTMs-in-Keras.jpg" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="The Keras deep learning library provides an implementation of the Long Short-Term Memory, or LSTM, recurrent neural network.

As part of this implementation, the Keras API provides access to both return sequences and return state. The use and difference between these data can be confusing when designing sophisticated recurrent neural network models, such as the encoder-decoder model.

In this tutorial, you will" />
<meta name="twitter:title" content="Difference Between Return Sequences and Return States for LSTMs in Keras - Machine Learning Mastery" />
<meta property="twitter:image" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Understand-the-Difference-Between-Return-Sequences-and-Return-States-for-LSTMs-in-Keras.jpg" />
    <script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<style id="wplmi-inline-css" type="text/css"> span.wplmi-user-avatar { width: 16px;display: inline-block !important;flex-shrink: 0; } img.wplmi-elementor-avatar { border-radius: 100%;margin-right: 3px; } 

</style>

<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/09/icon-16x16.png"/>

<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css" />

<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css" />

<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21" />
<meta name="generator" content="WooFramework 6.2.9" />
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32" />
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" />
<meta name="msapplication-TileImage" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}		</style>
		</head>
<body class="post-template-default single single-post postid-4560 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/09/Header_smaller_text_better-1.png" alt="Machine Learning Mastery" /></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="custom_html-39" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
	<a href="https://machinelearningmastery.lpages.co/lnwp-mini-course/">Click to Take the FREE LSTMs Crash-Course</a>
</div></div></div><div id="search-4" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/" >
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (this.value == 'Search...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search...';}" />
		<input type="hidden" name="post_type" value="post" />
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Neural Net Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li>
	<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-11055" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11055"><a href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li>
	<li id="menu-item-9966" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9966"><a href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li>
	<li id="menu-item-10674" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10674"><a href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li>
	<li id="menu-item-8989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8989"><a href="https://machinelearningmastery.com/category/probability/">Probability</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-4560 post type-post status-publish format-standard has-post-thumbnail hentry category-lstm">
	<header>
	<h1 class="title entry-title">Difference Between Return Sequences and Return States for LSTMs in Keras</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-10-24T05:00:22+1100">October 24, 2017</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/lstm/" title="View all items in Long Short-Term Memory Networks">Long Short-Term Memory Networks</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4560 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon"  data-href="https://twitter.com/share?text=Difference+Between+Return+Sequences+and+Return+States+for+LSTMs+in+Keras&url=https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"/><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"/></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" >
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"/> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"/> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"/> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p id="last-modified-info">Last Updated on August 14, 2019</p>
<p>The Keras deep learning library provides an implementation of the Long Short-Term Memory, or LSTM, recurrent neural network.</p>
<p>As part of this implementation, the Keras API provides access to both return sequences and return state. The use and difference between these data can be confusing when designing sophisticated recurrent neural network models, such as the encoder-decoder model.</p>
<p>In this tutorial, you will discover the difference and result of return sequences and return states for LSTM layers in the Keras deep learning library.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>That return sequences return the hidden state output for each input time step.</li>
<li>That return state returns the hidden state output and cell state for the last input time step.</li>
<li>That return sequences and return state can be used at the same time.</li>
</ul>
<p><strong>Kick-start your project</strong> with my new book <a href="https://machinelearningmastery.com/lstms-with-python/">Long Short-Term Memory Networks With Python</a>, including <em>step-by-step tutorials</em> and the <em>Python source code</em> files for all examples.</p>
<p>Let’s get started.</p>
<div id="attachment_4561" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-4561" loading="lazy" class="size-full wp-image-4561" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Understand-the-Difference-Between-Return-Sequences-and-Return-States-for-LSTMs-in-Keras.jpg" alt="Understand the Difference Between Return Sequences and Return States for LSTMs in Keras" width="640" height="480" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Understand-the-Difference-Between-Return-Sequences-and-Return-States-for-LSTMs-in-Keras.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Understand-the-Difference-Between-Return-Sequences-and-Return-States-for-LSTMs-in-Keras-300x225.jpg 300w" sizes="(max-width: 640px) 100vw, 640px" /><p id="caption-attachment-4561" class="wp-caption-text">Understand the Difference Between Return Sequences and Return States for LSTMs in Keras<br />Photo by <a href="https://www.flickr.com/photos/12327992@N06/33431042255/">Adrian Curt Dannemann</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 4 parts; they are:</p>
<ol>
<li>Long Short-Term Memory</li>
<li>Return Sequences</li>
<li>Return States</li>
<li>Return States and Sequences</li>
</ol>
<h2>Long Short-Term Memory</h2>
<p>The Long Short-Term Memory, or LSTM, is a recurrent neural network that is comprised of internal gates.</p>
<p>Unlike other recurrent neural networks, the network’s internal gates allow the model to be trained successfully using <a href="https://machinelearningmastery.com/gentle-introduction-backpropagation-time/">backpropagation through time</a>, or BPTT, and avoid the vanishing gradients problem.</p>
<p>In the Keras deep learning library, LSTM layers can be created using the <a href="https://keras.io/layers/recurrent/#lstm">LSTM() class</a>.</p>
<p>Creating a layer of LSTM memory units allows you to specify the number of memory units within the layer.</p>
<p>Each unit or cell within the layer has an internal cell state, often abbreviated as &#8220;<em>c</em>&#8220;, and outputs a hidden state, often abbreviated as &#8220;<em>h</em>&#8220;.</p>
<p>The Keras API allows you to access these data, which can be useful or even required when developing sophisticated recurrent neural network architectures, such as the encoder-decoder model.</p>
<p>For the rest of this tutorial, we will look at the API for access these data.</p>
<h2>Return Sequences</h2>
<p>Each LSTM cell will output one hidden state <em>h</em> for each input.</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7d5235056074" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
h = LSTM(X)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7d5235056074-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7d5235056074-1"><span class="crayon-v">h</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can demonstrate this in Keras with a very small model with a single LSTM layer that itself contains a single LSTM cell.</p>
<p>In this example, we will have one input sample with 3 time steps and one feature observed at each time step:</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7db839334436" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
t1 = 0.1
t2 = 0.2
t3 = 0.3</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7db839334436-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7db839334436-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7db839334436-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7db839334436-1">t1 = 0.1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7db839334436-2">t2 = 0.2</div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7db839334436-3">t3 = 0.3</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The complete example is listed below.</p>
<p>Note: all examples in this post use the <a href="https://keras.io/getting-started/functional-api-guide/">Keras functional API</a>.</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from keras.models import Model
from keras.layers import Input
from keras.layers import LSTM
from numpy import array
# define model
inputs1 = Input(shape=(3, 1))
lstm1 = LSTM(1)(inputs1)
model = Model(inputs=inputs1, outputs=lstm1)
# define input data
data = array([0.1, 0.2, 0.3]).reshape((1,3,1))
# make and show prediction
print(model.predict(data))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-5"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-6"><span class="crayon-v">inputs1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-7"><span class="crayon-v">lstm1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">inputs1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-8"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">inputs1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">lstm1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-9"><span class="crayon-p"># define input data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-10"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-11"><span class="crayon-p"># make and show prediction</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7dc768440867-12"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running the example outputs a single hidden state for the input sequence with 3 time steps.</p>
<p>Your specific output value will differ given the random initialization of the LSTM weights and cell state.</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7dd440140054" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[[-0.0953151]]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7dd440140054-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7dd440140054-1">[[-0.0953151]]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>It is possible to access the hidden state output for each input time step.</p>
<p>This can be done by setting the <em>return_sequences</em> attribute to <em>True</em> when defining the LSTM layer, as follows:</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7de909794859" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
LSTM(1, return_sequences=True)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7de909794859-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7de909794859-1"><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can update the previous example with this change.</p>
<p>The full code listing is provided below.</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7df545249569" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from keras.models import Model
from keras.layers import Input
from keras.layers import LSTM
from numpy import array
# define model
inputs1 = Input(shape=(3, 1))
lstm1 = LSTM(1, return_sequences=True)(inputs1)
model = Model(inputs=inputs1, outputs=lstm1)
# define input data
data = array([0.1, 0.2, 0.3]).reshape((1,3,1))
# make and show prediction
print(model.predict(data))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7df545249569-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-5"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-6"><span class="crayon-v">inputs1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-7"><span class="crayon-v">lstm1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">inputs1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-8"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">inputs1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">lstm1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-9"><span class="crayon-p"># define input data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-10"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-11"><span class="crayon-p"># make and show prediction</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7df545249569-12"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running the example returns a sequence of 3 values, one hidden state output for each input time step for the single LSTM cell in the layer.</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7e0143725497" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[[[-0.02243521]
  [-0.06210149]
  [-0.11457888]]]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e0143725497-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e0143725497-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e0143725497-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e0143725497-1">[[[-0.02243521]</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e0143725497-2">&nbsp;&nbsp;[-0.06210149]</div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e0143725497-3">&nbsp;&nbsp;[-0.11457888]]]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>You must set <em>return_sequences=True</em> when stacking LSTM layers so that the second LSTM layer has a three-dimensional sequence input. For more details, see the post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/stacked-long-short-term-memory-networks/">Stacked Long Short-Term Memory Networks</a></li>
</ul>
<p>You may also need to access the sequence of hidden state outputs when predicting a sequence of outputs with a <em>Dense</em> output layer wrapped in a TimeDistributed layer. See this post for more details:</p>
<ul>
<li><a href="https://machinelearningmastery.com/timedistributed-layer-for-long-short-term-memory-networks-in-python/">How to Use the TimeDistributed Layer for Long Short-Term Memory Networks in Python</a></li>
</ul>
<h2>Return States</h2>
<p>The output of an LSTM cell or layer of cells is called the hidden state.</p>
<p>This is confusing, because each LSTM cell retains an internal state that is not output, called the cell state, or <em>c</em>.</p>
<p>Generally, we do not need to access the cell state unless we are developing sophisticated models where subsequent layers may need to have their cell state initialized with the final cell state of another layer, such as in an encoder-decoder model.</p>
<p>Keras provides the return_state argument to the LSTM layer that will provide access to the hidden state output (<em>state_h</em>) and the cell state (<em>state_c</em>). For example:</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7e1291958569" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
lstm1, state_h, state_c = LSTM(1, return_state=True)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e1291958569-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e1291958569-1"><span class="crayon-v">lstm1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_state</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This may look confusing because both lstm1 and <em>state_h</em> refer to the same hidden state output. The reason for these two tensors being separate will become clear in the next section.</p>
<p>We can demonstrate access to the hidden and cell states of the cells in the LSTM layer with a worked example listed below.</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from keras.models import Model
from keras.layers import Input
from keras.layers import LSTM
from numpy import array
# define model
inputs1 = Input(shape=(3, 1))
lstm1, state_h, state_c = LSTM(1, return_state=True)(inputs1)
model = Model(inputs=inputs1, outputs=[lstm1, state_h, state_c])
# define input data
data = array([0.1, 0.2, 0.3]).reshape((1,3,1))
# make and show prediction
print(model.predict(data))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-5"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-6"><span class="crayon-v">inputs1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-7"><span class="crayon-v">lstm1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_state</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">inputs1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-8"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">inputs1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">lstm1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_c</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-9"><span class="crayon-p"># define input data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-10"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-11"><span class="crayon-p"># make and show prediction</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e3513462232-12"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Running the example returns 3 arrays:</p>
<ol>
<li>The LSTM hidden state output for the last time step.</li>
<li>The LSTM hidden state output for the last time step (again).</li>
<li>The LSTM cell state for the last time step.</li>
</ol>
<p></p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7e4748936673" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[array([[ 0.10951342]], dtype=float32),
 array([[ 0.10951342]], dtype=float32),
 array([[ 0.24143776]], dtype=float32)]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e4748936673-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e4748936673-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e4748936673-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e4748936673-1">[array([[ 0.10951342]], dtype=float32),</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e4748936673-2"> array([[ 0.10951342]], dtype=float32),</div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e4748936673-3"> array([[ 0.24143776]], dtype=float32)]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The hidden state and the cell state could in turn be used to initialize the states of another LSTM layer with the same number of cells.</p>
<h2>Return States and Sequences</h2>
<p>We can access both the sequence of hidden state and the cell states at the same time.</p>
<p>This can be done by configuring the LSTM layer to both return sequences and return states.</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7e5702758838" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
lstm1, state_h, state_c = LSTM(1, return_sequences=True, return_state=True)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e5702758838-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e5702758838-1"><span class="crayon-v">lstm1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_state</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The complete example is listed below.</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from keras.models import Model
from keras.layers import Input
from keras.layers import LSTM
from numpy import array
# define model
inputs1 = Input(shape=(3, 1))
lstm1, state_h, state_c = LSTM(1, return_sequences=True, return_state=True)(inputs1)
model = Model(inputs=inputs1, outputs=[lstm1, state_h, state_c])
# define input data
data = array([0.1, 0.2, 0.3]).reshape((1,3,1))
# make and show prediction
print(model.predict(data))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-5"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-6"><span class="crayon-v">inputs1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-7"><span class="crayon-v">lstm1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_state</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">inputs1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-8"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">inputs1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">lstm1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state_c</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-9"><span class="crayon-p"># define input data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-10"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-11"><span class="crayon-p"># make and show prediction</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e6809284392-12"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Running the example, we can see now why the LSTM output tensor and hidden state output tensor are declared separably.</p>
<p>The layer returns the hidden state for each input time step, then separately, the hidden state output for the last time step and the cell state for the last input time step.</p>
<p>This can be confirmed by seeing that the last value in the returned sequences (first array) matches the value in the hidden state (second array).</p><!-- Urvanov Syntax Highlighter v2.8.14 -->

		<div id="urvanov-syntax-highlighter-5f773a7a5e7e7182925580" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[array([[[-0.02145359],
        [-0.0540871 ],
        [-0.09228823]]], dtype=float32),
 array([[-0.09228823]], dtype=float32),
 array([[-0.19803026]], dtype=float32)]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e7182925580-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e7182925580-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e7182925580-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e7182925580-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-5f773a7a5e7e7182925580-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e7182925580-1">[array([[[-0.02145359],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e7182925580-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-0.0540871 ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e7182925580-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-0.09228823]]], dtype=float32),</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-5f773a7a5e7e7182925580-4"> array([[-0.09228823]], dtype=float32),</div><div class="crayon-line" id="urvanov-syntax-highlighter-5f773a7a5e7e7182925580-5"> array([[-0.19803026]], dtype=float32)]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking to go deeper.</p>
<ul>
<li><a href="https://keras.io/getting-started/functional-api-guide/">Keras Functional API</a></li>
<li><a href="https://keras.io/layers/recurrent/#lstm">LSTM API in Keras</a></li>
<li><a href="http://www.bioinf.jku.at/publications/older/2604.pdf">Long Short-Term Memory</a>, 1997.</li>
<li><a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">Understanding LSTM Networks</a>, 2015.</li>
<li><a href="https://blog.keras.io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras.html">A ten-minute introduction to sequence-to-sequence learning in Keras</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered the difference and result of return sequences and return states for LSTM layers in the Keras deep learning library.</p>
<p>Specifically, you learned:</p>
<ul>
<li>That return sequences return the hidden state output for each input time step.</li>
<li>That return state returns the hidden state output and cell state for the last input time step.</li>
<li>That return sequences and return state can be used at the same time.</li>
</ul>
<p>Do you have any questions?<br />
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="widget_text awac-wrapper" id="custom_html-74"><div class="widget_text awac widget custom_html-74"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2>Develop LSTMs for Sequence Prediction Today!</h2>
<a href="/lstms-with-python/" rel="nofollow"><img style="border: 0;" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/Cover-220.png" alt="Long Short-Term Memory Networks with Python" align="left" /></a>
<h4>Develop Your Own LSTM models in Minutes</h4>
<p>...with just a few lines of python code</p>

<p>Discover how in my new Ebook:<br>
<a href="/lstms-with-python/" rel="nofollow">Long Short-Term Memory Networks with Python</a></p>

<p>It provides <strong>self-study tutorials</strong> on topics like:<br>
<em>CNN LSTMs, Encoder-Decoder LSTMs, generative models, data preparation, making predictions</em> and much more...</p>

<h4>Finally Bring LSTM Recurrent Neural Networks to<br>
Your Sequence Predictions Projects</h4>
<p>Skip the Academics. Just Results.</p>

<a href="/lstms-with-python/" class="woo-sc-button  red" ><span class="woo-">See What's Inside</span></a>
</div></div></div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4560 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon"  data-href="https://twitter.com/share?text=Difference+Between+Return+Sequences+and+Return+States+for+LSTMs+in+Keras&url=https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"/><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"/></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" >
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"/> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"/> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"/> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=160&#038;d=mm&#038;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' loading='lazy'/></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">&rarr;</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/best-practices-document-classification-deep-learning/" rel="prev"><i class="fa fa-angle-left"></i> Best Practices for Text Classification with Deep Learning</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="next">How to Index, Slice and Reshape NumPy Arrays for Machine Learning <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">112 Responses to <em>Difference Between Return Sequences and Return States for LSTMs in Keras</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-417750" class="comment even thread-even depth-1">

	      	<div id="li-comment-417750" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1e8ced31df9006f997fd7004189bb1af?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1e8ced31df9006f997fd7004189bb1af?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nikeita</span>
	                <span class="date">October 24, 2017 at 5:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-417750" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for this!</p>
<p>To help people understand some applications of the output sequence and state visually, a picture like in the following stats overflow answer is great! </p>
<p><a href="https://stats.stackexchange.com/a/181544/37863" rel="nofollow ugc">https://stats.stackexchange.com/a/181544/37863</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417750' data-commentid="417750" data-postid="4560" data-belowelement="comment-417750" data-respondelement="respond" data-replyto="Reply to Nikeita" aria-label='Reply to Nikeita'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417820" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-417820" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 25, 2017 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-417820" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417820' data-commentid="417820" data-postid="4560" data-belowelement="comment-417820" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417790" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-417790" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thabet Ali</span>
	                <span class="date">October 25, 2017 at 12:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-417790" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Do you have plans to use more of the function API in your blog series?<br />
if so, why? </p>
<p>Best regards<br />
Thabet</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417790' data-commentid="417790" data-postid="4560" data-belowelement="comment-417790" data-respondelement="respond" data-replyto="Reply to Thabet Ali" aria-label='Reply to Thabet Ali'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417830" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-417830" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 25, 2017 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-417830" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it is needed for more advanced model development.</p>
<p>I will have a &#8220;how to&#8230;&#8221; post on the functional API soon. It is scheduled.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-417830' data-commentid="417830" data-postid="4560" data-belowelement="comment-417830" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418042" class="comment even thread-even depth-1">

	      	<div id="li-comment-418042" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">October 27, 2017 at 1:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-418042" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, is it possible to access the internal states through return_state = True and return_sequences = True with the Sequencial API? Moreover, is it possible to set the hidden state through a function like set_state() ?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-418042' data-commentid="418042" data-postid="4560" data-belowelement="comment-418042" data-respondelement="respond" data-replyto="Reply to Alex" aria-label='Reply to Alex'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418057" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418057" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 27, 2017 at 5:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-418057" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps, but not as far as I know or have tested.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-418057' data-commentid="418057" data-postid="4560" data-belowelement="comment-418057" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418065" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-418065" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/bc889007e6e9189126206d30e2955460?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bc889007e6e9189126206d30e2955460?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eldar</span>
	                <span class="date">October 27, 2017 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-418065" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, I wanted to show you this cool new RNN cell I&#8217;ve been trying out called &#8220;Recurrent Weighted Average&#8221; &#8211; it implements attention into the recurrent neural network &#8211; the keras implementation is available at <a href="https://github.com/keisuke-nakata/rwa" rel="nofollow ugc">https://github.com/keisuke-nakata/rwa</a> and the whitepaper is at <a href="https://arxiv.org/pdf/1703.01253.pdf" rel="nofollow ugc">https://arxiv.org/pdf/1703.01253.pdf</a></p>
<p>I&#8217;ve also seen that GRU is often a better choice unless the LSTM&#8217;s bias is initialized to ones, and it&#8217;s baked into Keras now (whitepaper for that at <a href="http://proceedings.mlr.press/v37/jozefowicz15.pdf" rel="nofollow ugc">http://proceedings.mlr.press/v37/jozefowicz15.pdf</a> )</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-418065' data-commentid="418065" data-postid="4560" data-belowelement="comment-418065" data-respondelement="respond" data-replyto="Reply to Eldar" aria-label='Reply to Eldar'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418103" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418103" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 27, 2017 at 2:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-418103" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very cool!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-418103' data-commentid="418103" data-postid="4560" data-belowelement="comment-418103" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418169" class="comment even thread-even depth-1">

	      	<div id="li-comment-418169" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/37f269b69eab2be9f8d4901b202336b2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/37f269b69eab2be9f8d4901b202336b2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">October 28, 2017 at 5:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-418169" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Just a note to say that return_state seems to be a recent addition to keras (since tensorflow 1.3 &#8211; if you are using keras in tensorflow contrib).</p>
<p>Shame it&#8217;s not available in earlier versions &#8211; I was looking forward to playing around with it 🙂</p>
<p>Alex</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-418169' data-commentid="418169" data-postid="4560" data-belowelement="comment-418169" data-respondelement="respond" data-replyto="Reply to Alex" aria-label='Reply to Alex'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418176" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418176" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 28, 2017 at 5:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-418176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Alex.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-418176' data-commentid="418176" data-postid="4560" data-belowelement="comment-418176" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418488" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-418488" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">October 30, 2017 at 9:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-418488" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, in these example you don&#8217;t fit.<br />
When you define the model like this:  model = Model(inputs=inputs1, outputs=[lstm1, state_h, state_c])   and then fit, the fit() function expects three values for the output instead of 1. How to correctly print the states (o see they change during training and/or prediction ?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-418488' data-commentid="418488" data-postid="4560" data-belowelement="comment-418488" data-respondelement="respond" data-replyto="Reply to Alex" aria-label='Reply to Alex'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418527" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418527" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 31, 2017 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-418527" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For a model that takes 2 inputs, they must be provided to fit() as an array.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-418527' data-commentid="418527" data-postid="4560" data-belowelement="comment-418527" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436110" class="comment even depth-3">

	      	<div id="li-comment-436110" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">April 27, 2018 at 6:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-436110" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, the question was about the outputs, not the inputs.. The problem is that if i set outputs=[lstm1, state_h, state_c] in the Model(), then the fit() function will expect three arrays as target arrays.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-436110' data-commentid="436110" data-postid="4560" data-belowelement="comment-436110" data-respondelement="respond" data-replyto="Reply to Alex" aria-label='Reply to Alex'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454217" class="comment odd alt depth-4">

	      	<div id="li-comment-454217" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2af066e591bb22b868ac62af16f325b6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2af066e591bb22b868ac62af16f325b6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pradyumna Majumder</span>
	                <span class="date">November 9, 2018 at 11:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-454217" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Alex, did u find how to handle the fit in this case?</p>
<p>Suppose i have</p>
<p>model = Model(inputs=[input_x, h_one_in , h_two_in], outputs=[y1,y2,state_h,state_c])</p>
<p>how would I write my mode.fit? in the input and outputs?</p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-454217' data-commentid="454217" data-postid="4560" data-belowelement="comment-454217" data-respondelement="respond" data-replyto="Reply to Pradyumna Majumder" aria-label='Reply to Pradyumna Majumder'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-489749" class="comment even depth-5">

	      	<div id="li-comment-489749" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b08be4d4c221b02b9ddd0d523bd6a4c8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b08be4d4c221b02b9ddd0d523bd6a4c8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fatih</span>
	                <span class="date">June 21, 2019 at 7:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-489749" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>+1</p>
<p>I use random initialization but the results are disappointing.</p>
<p>Any other ideas?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419352" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-419352" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2fc5807f17b50de68e58a803e8173a56?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2fc5807f17b50de68e58a803e8173a56?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">MT</span>
	                <span class="date">November 8, 2017 at 9:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-419352" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, </p>
<p>Brilliant post as usual. I am also going to buy your LSTM book. </p>
<p>I however had a question on Keras LSTM error I have been getting and was hoping if you could help that? </p>
<p>Getting an error like this </p>
<p>&#8220;You must feed a value for placeholder tensor &#8217;embedding_layer_input'&#8221;</p>
<p>/usr/local/lib/python3.5/site-packages/tensorflow/python/framework/errors_impl.py in raise_exception_on_not_ok_status()<br />
    465           compat.as_text(pywrap_tensorflow.TF_Message(status)),<br />
&#8211;&gt; 466           pywrap_tensorflow.TF_GetCode(status))<br />
    467   finally:</p>
<p>InvalidArgumentError: You must feed a value for placeholder tensor &#8217;embedding_layer_input&#8217; with dtype float<br />
     [[Node: embedding_layer_input = Placeholder[dtype=DT_FLOAT, shape=[], _device=&#8221;/job:localhost/replica:0/task:0/gpu:0&#8243;]()]]<br />
     [[Node: output_layer_2/bias/read/_237 = _Recv[client_terminated=false, recv_device=&#8221;/job:localhost/replica:0/task:0/cpu:0&#8243;, send_device=&#8221;/job:localhost/replica:0/task:0/gpu:0&#8243;, send_device_incarnation=1, tensor_name=&#8221;edge_1546_output_layer_2/bias/read&#8221;, tensor_type=DT_FLOAT, _device=&#8221;/job:localhost/replica:0/task:0/cpu:0&#8243;]()]]</p>
<p>During handling of the above exception, another exception occurred:</p>
<p>Here is the code I wrote for this: </p>
<p>def model_param(self): </p>
<p>        # Method to do deep learning</p>
<p>        from keras.models import Sequential<br />
        from keras.layers import Dense, Flatten, Dropout, Activation<br />
        from keras.layers import LSTM<br />
        from keras.layers.embeddings import Embedding<br />
        from keras.initializers import TruncatedNormal</p>
<p>        tn=TruncatedNormal(mean=0.0, stddev=1/sqrt(self.x_train.shape[1]*self.x_train.shape[1]), seed=2)</p>
<p>        self.model = Sequential()<br />
        self.model.add(Embedding(self.len_vocab,300,input_length=self.x_train.shape[1]))</p>
<p>        # Adding LSTM cell<br />
        self.model.add(LSTM(self.num_units,dropout=0.30,kernel_initializer=tn,name=&#8221;lstm_1&#8243;))<br />
        # Adding the dense output layer for Output<br />
        self.model.add(Dense(1,activation=&#8221;sigmoid&#8221;,name=&#8221;output_layer&#8221;))</p>
<p>        #sgd = SGD(lr=0.01, decay=1e-6, momentum=0.9, nesterov=True)<br />
        self.model.compile(loss=&#8217;binary_crossentropy&#8217;,<br />
              optimizer=&#8221;adam&#8221;,<br />
              metrics=[&#8216;accuracy&#8217;])</p>
<p>        self.model.summary()</p>
<p>    def fit(self):<br />
        # Training the deep learning network on the training data</p>
<p>        # Adding the callbacks for Logging </p>
<p>        import keras<br />
        logger_tb=keras.callbacks.TensorBoard(<br />
        log_dir=&#8221;logs_sentiment_lstm&#8221;,<br />
        write_graph=True,<br />
        histogram_freq=5<br />
        )</p>
<p>        self.model.fit(self.x_train, self.y_train,validation_split=0.20,<br />
          epochs=10,<br />
          batch_size=128,callbacks=[logger_tb]<br />
        )</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419352' data-commentid="419352" data-postid="4560" data-belowelement="comment-419352" data-respondelement="respond" data-replyto="Reply to MT" aria-label='Reply to MT'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419477" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-419477" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 9, 2017 at 9:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-419477" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ouch, I have not seen this fault before.</p>
<p>Perhaps try simplifying the example to flush out the cause?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419477' data-commentid="419477" data-postid="4560" data-belowelement="comment-419477" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-489698" class="comment odd alt depth-2">

	      	<div id="li-comment-489698" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c4c0775065144d80a7689839179eb162?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c4c0775065144d80a7689839179eb162?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kumar Nilay</span>
	                <span class="date">June 21, 2019 at 11:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-489698" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>histogram_freq=5 is causing this error, this is a bug in keras, set histogram_freq=0 and it should work fine</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489698' data-commentid="489698" data-postid="4560" data-belowelement="comment-489698" data-respondelement="respond" data-replyto="Reply to Kumar Nilay" aria-label='Reply to Kumar Nilay'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-489714" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-489714" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 21, 2019 at 2:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-489714" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489714' data-commentid="489714" data-postid="4560" data-belowelement="comment-489714" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419784" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-419784" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/63898708b1689be659154d2ece424ca8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/63898708b1689be659154d2ece424ca8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Julian</span>
	                <span class="date">November 12, 2017 at 8:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-419784" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is another great Post Jason! I am a fan of all your RRNs posts. 😉 Thanks!</p>
<p>In case anyone was wondering the difference between c (Internal state) and h (Hidden state) in a LSTM, this answer was very helpful for me:</p>
<p><a href="https://www.quora.com/What-is-the-difference-between-states-and-outputs-in-LSTM" rel="nofollow ugc">https://www.quora.com/What-is-the-difference-between-states-and-outputs-in-LSTM</a></p>
<p>Would be correct to say that in a GRU and SimpleRNN, the c=h?</p>
<p>Thanks in advance!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419784' data-commentid="419784" data-postid="4560" data-belowelement="comment-419784" data-respondelement="respond" data-replyto="Reply to Julian" aria-label='Reply to Julian'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419799" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-419799" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 12, 2017 at 9:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-419799" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Julian.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-419799' data-commentid="419799" data-postid="4560" data-belowelement="comment-419799" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421001" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-421001" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/98d5d3be44f3ff4eed559d7f70940500?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/98d5d3be44f3ff4eed559d7f70940500?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kaushal Shetty</span>
	                <span class="date">November 24, 2017 at 12:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-421001" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
In the implementation of encoder-decoder in keras we do a return state in the encoder network which means that we get state_h and state_c after which the [state_h,state_c] is set as initial state of the decoder network. What does setting the initial state mean for a LSTM network? Is it that the state_h of decoder = [state_h,state_c].</p>
<p>Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-421001' data-commentid="421001" data-postid="4560" data-belowelement="comment-421001" data-respondelement="respond" data-replyto="Reply to Kaushal Shetty" aria-label='Reply to Kaushal Shetty'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421045" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-421045" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 24, 2017 at 9:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-421045" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, here is an example:<br />
<a href="https://machinelearningmastery.com/develop-encoder-decoder-model-sequence-sequence-prediction-keras/" rel="nofollow ugc">https://machinelearningmastery.com/develop-encoder-decoder-model-sequence-sequence-prediction-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-421045' data-commentid="421045" data-postid="4560" data-belowelement="comment-421045" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421098" class="comment odd alt depth-3">

	      	<div id="li-comment-421098" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/98d5d3be44f3ff4eed559d7f70940500?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/98d5d3be44f3ff4eed559d7f70940500?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kaushal Shetty</span>
	                <span class="date">November 24, 2017 at 9:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-421098" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great. I think i get it now. Basically when we give return_state=True for a LSTM then the LSTM will accept three inputs that is decoder_actual_input,state_h,state_c. And during inference we again reset the state_c and state_h with state_h and state_c of previous prediction. Am i correct on my assumption ? </p>
<p>I am still a little bit  confused why we use three keras models (model,encoder_model and decoder_model). </p>
<p>Thank You.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-421098' data-commentid="421098" data-postid="4560" data-belowelement="comment-421098" data-respondelement="respond" data-replyto="Reply to Kaushal Shetty" aria-label='Reply to Kaushal Shetty'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421139" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-421139" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 25, 2017 at 10:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-421139" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The return_state argument only controls whether the state is returned. A different argument is used to initialize state for an LSTM (e.g. during the definition of the model with the functional API).</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-421139' data-commentid="421139" data-postid="4560" data-belowelement="comment-421139" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421340" class="comment odd alt depth-5">

	      	<div id="li-comment-421340" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/98d5d3be44f3ff4eed559d7f70940500?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/98d5d3be44f3ff4eed559d7f70940500?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kaushal Shetty</span>
	                <span class="date">November 27, 2017 at 4:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-421340" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Got it. Its initial_state. Thank You Jason.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-421422" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-421422" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 28, 2017 at 8:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-421422" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425896" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-425896" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/cc63d6185199d1aaab7e8ca973f0a59f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cc63d6185199d1aaab7e8ca973f0a59f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nathan D.</span>
	                <span class="date">January 9, 2018 at 1:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-425896" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I do enjoy reading your blog. I have 2 short questions for this post and hope you could kindly address them briefly:</p>
<p>1. Can we return the sequence of cell states (a sort of variable similar to *lstm1*)?</p>
<p>2. No matter the dimension (I mean #features) of the input sequence, as we place 1 LSTMcell in the layer, both the hidden and cell states are always a scalar, right? As such, the kernel_ and recurrent_kernel_ properties in Keras (at each gate) are not in the matrix form. However, I believe your standpoint on viewing each LSTM cell having 1Dim hidden state/cell makes sense in the case of dropout in deep learning. </p>
<p>Please correct me if I misunderstood your post.  Thank you.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425896' data-commentid="425896" data-postid="4560" data-belowelement="comment-425896" data-respondelement="respond" data-replyto="Reply to Nathan D." aria-label='Reply to Nathan D.'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425920" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-425920" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 9, 2018 at 5:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-425920" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not directly, perhaps by calling the model recursively.</p>
<p>I think you&#8217;re right.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-425920' data-commentid="425920" data-postid="4560" data-belowelement="comment-425920" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-503741" class="comment odd alt depth-2">

	      	<div id="li-comment-503741" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b457d86a71f233393de9123eaaeae3a9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b457d86a71f233393de9123eaaeae3a9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tianyu</span>
	                <span class="date">October 2, 2019 at 9:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-503741" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have the same questions like Q1, so how do you output the sequence of cell states? Thank you.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-503741' data-commentid="503741" data-postid="4560" data-belowelement="comment-503741" data-respondelement="respond" data-replyto="Reply to Tianyu" aria-label='Reply to Tianyu'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503798" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-503798" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 3, 2019 at 6:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-503798" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You don&#8217;t, generally. You output a sequence of activations, referred to in the papers as h.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-503798' data-commentid="503798" data-postid="4560" data-belowelement="comment-503798" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428028" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-428028" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/37bf72e19eee7e2d9ccb2817b770268b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/37bf72e19eee7e2d9ccb2817b770268b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zebo Li</span>
	                <span class="date">January 31, 2018 at 2:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-428028" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, very good explanation.<br />
One question, I thought h = activation (o), is that correct? (h: hidden state output, o: hidden cell)<br />
But tanh(-0.19803026) does not equals -0.09228823. (The default activation for LSTM should be tanh)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-428028' data-commentid="428028" data-postid="4560" data-belowelement="comment-428028" data-respondelement="respond" data-replyto="Reply to Zebo Li" aria-label='Reply to Zebo Li'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-430567" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-430567" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4acb82b40d9e5bd56ae9e8f61542fec2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4acb82b40d9e5bd56ae9e8f61542fec2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vinayaka</span>
	                <span class="date">February 27, 2018 at 1:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-430567" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much, Jason. This cleared my doubt.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-430567' data-commentid="430567" data-postid="4560" data-belowelement="comment-430567" data-respondelement="respond" data-replyto="Reply to Vinayaka" aria-label='Reply to Vinayaka'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430602" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-430602" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 27, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-430602" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m glad to hear that.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-430602' data-commentid="430602" data-postid="4560" data-belowelement="comment-430602" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431332" class="comment even thread-even depth-1">

	      	<div id="li-comment-431332" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/078dcceb05ffd887265c31460fb702c3?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/078dcceb05ffd887265c31460fb702c3?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jason</span>
	                <span class="date">March 6, 2018 at 2:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-431332" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much for writing this. This is really a big help.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-431332' data-commentid="431332" data-postid="4560" data-belowelement="comment-431332" data-respondelement="respond" data-replyto="Reply to Jason" aria-label='Reply to Jason'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431340" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-431340" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 6, 2018 at 2:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-431340" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I&#8217;m glad it helped.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-431340' data-commentid="431340" data-postid="4560" data-belowelement="comment-431340" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432345" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-432345" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2cb808da0b4c7f0fd5ea25c208ef12e3?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2cb808da0b4c7f0fd5ea25c208ef12e3?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">tiopon</span>
	                <span class="date">March 16, 2018 at 3:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-432345" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hey Jason， how could i get the final hidden state and sequence both when using a bidirectional wrapper？</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-432345' data-commentid="432345" data-postid="4560" data-belowelement="comment-432345" data-respondelement="respond" data-replyto="Reply to tiopon" aria-label='Reply to tiopon'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432399" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-432399" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 17, 2018 at 8:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-432399" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Does the above post not help?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-432399' data-commentid="432399" data-postid="4560" data-belowelement="comment-432399" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-434828" class="comment even thread-even depth-1">

	      	<div id="li-comment-434828" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">April 12, 2018 at 4:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-434828" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, can I connect the output of a dense layer to the c state of a LSTM in such a way that it initialize the state c with this value before each batch? Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-434828' data-commentid="434828" data-postid="4560" data-belowelement="comment-434828" data-respondelement="respond" data-replyto="Reply to Alex" aria-label='Reply to Alex'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434875" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-434875" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 13, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-434875" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m sure you can (it&#8217;s all just code), but it might require some careful programming. I don&#8217;t have good advice other than lots of trial and error.</p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-434875' data-commentid="434875" data-postid="4560" data-belowelement="comment-434875" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-434865" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-434865" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f09a731be10c5329834b8e5c71a2d802?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f09a731be10c5329834b8e5c71a2d802?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andrew</span>
	                <span class="date">April 13, 2018 at 2:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-434865" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What is the hidden state and cell state of the first input if it does not have a previous hidden or cell state to reference?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-434865' data-commentid="434865" data-postid="4560" data-belowelement="comment-434865" data-respondelement="respond" data-replyto="Reply to Andrew" aria-label='Reply to Andrew'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434886" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-434886" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 13, 2018 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-434886" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It will be zero.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-434886' data-commentid="434886" data-postid="4560" data-belowelement="comment-434886" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443645" class="comment even thread-even depth-1">

	      	<div id="li-comment-443645" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/890f79c87078158c2a2a49e9e9f1e6c4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/890f79c87078158c2a2a49e9e9f1e6c4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali</span>
	                <span class="date">July 17, 2018 at 4:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-443645" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When I use following code based on bidirectional LSTM, it retruns this error:<br />
    &#8216; is not connected, no input to return.&#8217;)<br />
AttributeError: Layer sequential_1 is not connected, no input to return.</p>
<p>But when ordinary LSTM (commented code) is ran, it returns correctly.</p>
<p>        self.model = Sequential()<br />
        # self.model.add(LSTM(input_shape=(None,self.num_encoder_tokens), units=self.n_hidden,<br />
        #                                   return_sequences=True,name=&#8217;hidden&#8217;))<br />
        # self.model.add(LSTM(units=self.num_encoder_tokens, return_sequences=True))<br />
        # self.intermediate_layer = Model(inputs=self.model.input, outputs=self.model.get_layer(&#8216;hidden&#8217;).output)<br />
        self.model.add(Bidirectional(LSTM(input_shape=(None,self.num_encoder_tokens), units=self.n_hidden,<br />
                                          return_sequences=True,name=&#8217;hidden&#8217;),merge_mode=&#8217;concat&#8217;))<br />
        self.model.add(Bidirectional(LSTM(units=self.num_encoder_tokens, return_sequences=True),merge_mode=&#8217;concat&#8217;))<br />
        self.intermediate_layer = Model(input=self.model.input,output=self.model.get_layer(&#8216;hidden&#8217;).output)</p>
<p>why?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-443645' data-commentid="443645" data-postid="4560" data-belowelement="comment-443645" data-respondelement="respond" data-replyto="Reply to Ali" aria-label='Reply to Ali'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443673" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-443673" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 17, 2018 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-443673" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-443673' data-commentid="443673" data-postid="4560" data-belowelement="comment-443673" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-485343" class="comment even depth-2">

	      	<div id="li-comment-485343" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ba7a4c542ddee210941071267903e378?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ba7a4c542ddee210941071267903e378?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harish</span>
	                <span class="date">May 14, 2019 at 2:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-485343" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p><a href="https://stackoverflow.com/questions/49313650/how-could-i-get-both-the-final-hidden-state-and-sequence-in-a-lstm-layer-when-us" rel="nofollow ugc">https://stackoverflow.com/questions/49313650/how-could-i-get-both-the-final-hidden-state-and-sequence-in-a-lstm-layer-when-us</a></p>
<p>This can help</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-485343' data-commentid="485343" data-postid="4560" data-belowelement="comment-485343" data-respondelement="respond" data-replyto="Reply to Harish" aria-label='Reply to Harish'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443716" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-443716" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/890f79c87078158c2a2a49e9e9f1e6c4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/890f79c87078158c2a2a49e9e9f1e6c4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali</span>
	                <span class="date">July 17, 2018 at 11:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-443716" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is there no reply for this?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-443716' data-commentid="443716" data-postid="4560" data-belowelement="comment-443716" data-respondelement="respond" data-replyto="Reply to Ali" aria-label='Reply to Ali'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-447978" class="comment even thread-even depth-1">

	      	<div id="li-comment-447978" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4a5aedc903158f6813321ec201ae7d3b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4a5aedc903158f6813321ec201ae7d3b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam</span>
	                <span class="date">September 6, 2018 at 7:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-447978" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much for your explanation!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-447978' data-commentid="447978" data-postid="4560" data-belowelement="comment-447978" data-respondelement="respond" data-replyto="Reply to Sam" aria-label='Reply to Sam'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-448009" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-448009" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 6, 2018 at 2:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-448009" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m happy it helped Sam!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-448009' data-commentid="448009" data-postid="4560" data-belowelement="comment-448009" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454694" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-454694" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a309c869da076b74a18bb4b3e40fe5ad?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a309c869da076b74a18bb4b3e40fe5ad?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Klaas Brau</span>
	                <span class="date">November 14, 2018 at 4:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-454694" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Awesome Work Jason. I always thought the last hidden state is equal to the cell state. So I was wrong and the hidden state and the cell state is never the same?<br />
Thank you</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-454694' data-commentid="454694" data-postid="4560" data-belowelement="comment-454694" data-respondelement="respond" data-replyto="Reply to Klaas Brau" aria-label='Reply to Klaas Brau'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454727" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-454727" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 14, 2018 at 7:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-454727" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, they are different things.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-454727' data-commentid="454727" data-postid="4560" data-belowelement="comment-454727" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455934" class="comment even thread-even depth-1">

	      	<div id="li-comment-455934" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4f9cdb1d3c27720c539509f78914a112?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4f9cdb1d3c27720c539509f78914a112?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hussain</span>
	                <span class="date">November 23, 2018 at 8:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-455934" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br />
I just wanna thank you for the entire site.<br />
Whenever I am stuck in code or concepts I visit your site and things get cleared up.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-455934' data-commentid="455934" data-postid="4560" data-belowelement="comment-455934" data-respondelement="respond" data-replyto="Reply to Hussain" aria-label='Reply to Hussain'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455976" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455976" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 24, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-455976" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I&#8217;m glad its helpful!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-455976' data-commentid="455976" data-postid="4560" data-belowelement="comment-455976" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-459684" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-459684" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4c955d96772298120aca6f9223fc0fb8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4c955d96772298120aca6f9223fc0fb8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Clive</span>
	                <span class="date">December 23, 2018 at 4:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-459684" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi so in the above example our network consist of only one lstm node or cell<br />
And the output is feed to it of 3 timestamps one at a time ? </p>
<p>Or does it have 3 cells for each timestemp</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-459684' data-commentid="459684" data-postid="4560" data-belowelement="comment-459684" data-respondelement="respond" data-replyto="Reply to Clive" aria-label='Reply to Clive'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459702" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-459702" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 23, 2018 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-459702" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The number of nodes in the LSTM is unrelated to the number of time steps in the data sample.</p>
<p>Perhaps this will make things clearer for you:<br />
<a href="https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/" rel="nofollow ugc">https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-459702' data-commentid="459702" data-postid="4560" data-belowelement="comment-459702" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-463930" class="comment even thread-even depth-1">

	      	<div id="li-comment-463930" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/fda5f1787e764f8a4c0b7ba80e7be001?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fda5f1787e764f8a4c0b7ba80e7be001?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">mk</span>
	                <span class="date">January 17, 2019 at 6:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-463930" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>&#8220;Generally, we do not need to access the cell state unless we are developing sophisticated models where subsequent layers may need to have their cell state initialized with the final cell state of another layer, such as in an encoder-decoder model.&#8221;<br />
in the another your post,encoder-decoder  LSTM Model code as fllower:<br />
model.add(LSTM(200, activation=&#8217;relu&#8217;, input_shape=(n_timesteps, n_features)))<br />
model.add(RepeatVector(n_outputs))<br />
model.add(LSTM(200, activation=&#8217;relu&#8217;, return_sequences=True))<br />
but return_state = false?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-463930' data-commentid="463930" data-postid="4560" data-belowelement="comment-463930" data-respondelement="respond" data-replyto="Reply to mk" aria-label='Reply to mk'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464007" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-464007" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 18, 2019 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-464007" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-464007' data-commentid="464007" data-postid="4560" data-belowelement="comment-464007" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-467525" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-467525" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/115646af72ae607701658cc80d47a93b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/115646af72ae607701658cc80d47a93b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">M</span>
	                <span class="date">February 9, 2019 at 12:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-467525" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br />
Thanks for the great post. I have a quick question about the bottleneck in the LSTM encoder above. As I understand it, if the encoder has say 50 cells, then does this mean that the hidden state of the encoder LSTM layer contains 50 values, one per cell? </p>
<p>If this is correct, then would it be accurate to say that if the original data had 50 timesteps and a dimensionality/feature count of 3, then having an encoder LSTM with 20 cells (which would give a hidden state of 20 values) could be considered to be a sort of compression/dimensionality reduction (a la autoencoders and compressed representations) ?</p>
<p>Finally, does it make sense to apply have a fully-connected layer with some nonlinearity operating on the hidden state for purposes of dimensionality reduction i.e hidden state with 50 values -&gt; FFlayer with 10 neurons, &#8216;compressing&#8217; the 50 values to 10&#8230;?</p>
<p>Thanks again</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-467525' data-commentid="467525" data-postid="4560" data-belowelement="comment-467525" data-respondelement="respond" data-replyto="Reply to M" aria-label='Reply to M'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467554" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-467554" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 9, 2019 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-467554" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, correct.</p>
<p>If you want to use the hidden state as a learned feature, you could feed it into a new fully connected model.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-467554' data-commentid="467554" data-postid="4560" data-belowelement="comment-467554" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467605" class="comment even depth-3">

	      	<div id="li-comment-467605" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/115646af72ae607701658cc80d47a93b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/115646af72ae607701658cc80d47a93b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">M</span>
	                <span class="date">February 9, 2019 at 11:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-467605" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Brilliant, thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-467605' data-commentid="467605" data-postid="4560" data-belowelement="comment-467605" data-respondelement="respond" data-replyto="Reply to M" aria-label='Reply to M'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-470372" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-470372" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d1165ccadce6754e162b994881bcfd67?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d1165ccadce6754e162b994881bcfd67?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://appsflyer.com' rel='external nofollow ugc' class='url'>Shlomi Schwartz</a></span>
	                <span class="date">February 24, 2019 at 11:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-470372" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellent post, how would one save the state when prediction samples arrives from multiple sources, like the question posted here <a href="https://stackoverflow.com/questions/54850854/keras-restore-lstm-hidden-state-for-a-specific-time-stamp" rel="nofollow ugc">https://stackoverflow.com/questions/54850854/keras-restore-lstm-hidden-state-for-a-specific-time-stamp</a> ?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-470372' data-commentid="470372" data-postid="4560" data-belowelement="comment-470372" data-respondelement="respond" data-replyto="Reply to Shlomi Schwartz" aria-label='Reply to Shlomi Schwartz'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-470439" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-470439" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 25, 2019 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-470439" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can save state by retrieving it from the model and saving it to a file.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-470439' data-commentid="470439" data-postid="4560" data-belowelement="comment-470439" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-470550" class="comment odd alt depth-3">

	      	<div id="li-comment-470550" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d1165ccadce6754e162b994881bcfd67?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d1165ccadce6754e162b994881bcfd67?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://appsflyer.com' rel='external nofollow ugc' class='url'>Shlomi Schwartz</a></span>
	                <span class="date">February 25, 2019 at 6:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-470550" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much 🙂</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-470550' data-commentid="470550" data-postid="4560" data-belowelement="comment-470550" data-respondelement="respond" data-replyto="Reply to Shlomi Schwartz" aria-label='Reply to Shlomi Schwartz'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-471962" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-471962" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0ab87b42505b8d58f498544595523245?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0ab87b42505b8d58f498544595523245?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://NA' rel='external nofollow ugc' class='url'>Sandeli</a></span>
	                <span class="date">March 3, 2019 at 8:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-471962" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason</p>
<p>Thank you very much for the great post. Currently I am working on two-stream LSTM network(sequence of images) and I am trying to extract both LSTMs each time step&#8217;s cell state and calculate the average value. Afterwards update next  time step with this previous time step&#8217;s average value + existing cell state value. And continue this process thru all time steps.</p>
<p>Greatly appreciate if you could explain me how do we update LSTM cell states(as each time steps) by giving additional value. Thank you very much.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-471962' data-commentid="471962" data-postid="4560" data-belowelement="comment-471962" data-respondelement="respond" data-replyto="Reply to Sandeli" aria-label='Reply to Sandeli'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472075" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-472075" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 4, 2019 at 6:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-472075" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why are you trying to average the cell state exactly?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472075' data-commentid="472075" data-postid="4560" data-belowelement="comment-472075" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472182" class="comment even depth-3">

	      	<div id="li-comment-472182" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0ab87b42505b8d58f498544595523245?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0ab87b42505b8d58f498544595523245?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://NA' rel='external nofollow ugc' class='url'>Sandeli</a></span>
	                <span class="date">March 4, 2019 at 1:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-472182" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you very much for your response. I am doing it the following way</p>
<pre
X = X.reshape((X.shape[0], X.shape[3], X.shape[1]*X.shape[2]*X.shape[4])) # (30, 10, 7500)--&gt; #videos, #frames, height*width*channels
	Xd = X.reshape((Xd.shape[0], Xd.shape[3], Xd.shape[1]*Xd.shape[2]*Xd.shape[4]))
	#Both testing data
    Xtst = Xtst.reshape((Xtst.shape[0], Xtst.shape[3], Xtst.shape[1] * Xtst.shape[2] * Xtst.shape[4]))
    Xtsto = Xtsto.reshape((Xtsto.shape[0], Xtsto.shape[3], Xtsto.shape[1] * Xtsto.shape[2] * Xtsto.shape[4]))

    Input_rgb = Input(shape=X.shape[1:], name='inputRgb')
    Input_opt = Input(shape=Xd.shape[1:], name='inputOpt')

	#for RGB stream
    lstm1, state_h1, state_c1 = LSTM(125, return_sequences=True, return_state=True,)(Input_rgb)
    model1 = Model(inputs=Input_rgb, outputs=[lstm1, state_h1, state_c1])

	#for RGB stream
    lstm2, state_h2, state_c2 = LSTM(125, return_sequences=True, return_state=True)(Input_opt)
    model2 = Model(inputs=Input_opt, outputs=[lstm2, state_h2, state_c2])

    data1 = array(X[2]).reshape((1, X.shape[1], X.shape[2])) # print("data1", data1.shape)--&gt; data1 (1, 10, 7500)
    data2 = array(Xd[2]).reshape((1, Xd.shape[1], Xd.shape[2]))
    
    # make and show prediction
    states1 = model1.predict(data1)  # (X)
    states2 = model2.predict(data2)  # (Xd)

    updateCells = ((states1[2] + states2[2]) / 2)  # average
    newCel = updateCells[0] ###need to add or do avg(with existing cell state value of next time step) this newCel value to both lstms' cell states
	
	model11 = Dropout(0.25)(model1.outputs[0])
    out1 = TimeDistributed(Dense(1))(model11)
    out1 = Flatten()(out1)

    model22 = Dropout(0.25)(model2.outputs[0])
    out2 = TimeDistributed(Dense(1))(model22)
    out2 = Flatten()(out2)

    output1 = Dense(5, activation='softmax')(out1)
    output2 = Dense(5, activation='softmax')(out2)
    output = average([output1, output2])
</pre>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472182' data-commentid="472182" data-postid="4560" data-belowelement="comment-472182" data-respondelement="respond" data-replyto="Reply to Sandeli" aria-label='Reply to Sandeli'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472183" class="comment odd alt depth-4">

	      	<div id="li-comment-472183" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0ab87b42505b8d58f498544595523245?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0ab87b42505b8d58f498544595523245?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://NA' rel='external nofollow ugc' class='url'>Sandeli</a></span>
	                <span class="date">March 4, 2019 at 1:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-472183" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Please be noted 2nd LSTM is for Optical flow stream mistakenly comment both LSTMs for RGB. Thank you.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472183' data-commentid="472183" data-postid="4560" data-belowelement="comment-472183" data-respondelement="respond" data-replyto="Reply to Sandeli" aria-label='Reply to Sandeli'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-472198" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-472198" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 4, 2019 at 2:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-472198" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why? Why do you want to do this?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472198' data-commentid="472198" data-postid="4560" data-belowelement="comment-472198" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472248" class="comment odd alt depth-5">

	      	<div id="li-comment-472248" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0ab87b42505b8d58f498544595523245?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0ab87b42505b8d58f498544595523245?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://NA' rel='external nofollow ugc' class='url'>Sandeli</a></span>
	                <span class="date">March 4, 2019 at 6:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-472248" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Currently I working on two-steam networks with image sequence. I want to study that is there any advantage of communicating cells states in each time steps of both streams rather than without communicate (just as normal 2-stream network) as part of my research. Thank you for your concern.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472230" class="comment even thread-even depth-1">

	      	<div id="li-comment-472230" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0ab87b42505b8d58f498544595523245?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0ab87b42505b8d58f498544595523245?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://NA' rel='external nofollow ugc' class='url'>Sandeli</a></span>
	                <span class="date">March 4, 2019 at 4:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-472230" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Currently I working on two-steam networks with image sequence. I want to study that is there any advantage of communicating cells states in each time steps of both streams rather than without communicate (just as normal 2-stream network) as part of my research. Thank you for your concern.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472230' data-commentid="472230" data-postid="4560" data-belowelement="comment-472230" data-respondelement="respond" data-replyto="Reply to Sandeli" aria-label='Reply to Sandeli'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472337" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-472337" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 5, 2019 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-472337" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting, let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472337' data-commentid="472337" data-postid="4560" data-belowelement="comment-472337" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472636" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-472636" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/05744d8c88e37c9f12dc09db74b5e1d2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/05744d8c88e37c9f12dc09db74b5e1d2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">saria</span>
	                <span class="date">March 6, 2019 at 4:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-472636" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Really great article, Thanks a lot:)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472636' data-commentid="472636" data-postid="4560" data-belowelement="comment-472636" data-respondelement="respond" data-replyto="Reply to saria" aria-label='Reply to saria'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472705" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-472705" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 6, 2019 at 7:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-472705" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-472705' data-commentid="472705" data-postid="4560" data-belowelement="comment-472705" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-482899" class="comment even thread-even depth-1">

	      	<div id="li-comment-482899" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6114134012a89704295382fb669a7174?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6114134012a89704295382fb669a7174?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jay</span>
	                <span class="date">April 27, 2019 at 6:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-482899" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It really solved my confusion. Thank you 🙂</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-482899' data-commentid="482899" data-postid="4560" data-belowelement="comment-482899" data-respondelement="respond" data-replyto="Reply to Jay" aria-label='Reply to Jay'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482979" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-482979" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 28, 2019 at 6:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-482979" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m happy to hear that.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-482979' data-commentid="482979" data-postid="4560" data-belowelement="comment-482979" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-485339" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-485339" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ba7a4c542ddee210941071267903e378?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ba7a4c542ddee210941071267903e378?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harish</span>
	                <span class="date">May 14, 2019 at 2:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-485339" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason,</p>
<p>Can you pls tell me how to use return states with Bidirectional wrapper on LSTM? The unpacking of outputs throws error</p>
<p>code:<br />
encoder = Bidirectional(LSTM(n_a, return_state=True))<br />
encoder_outputs, state_h, state_c = encoder(encoder_inputs)</p>
<p>error:<br />
ValueError: too many values to unpack (expected 3)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-485339' data-commentid="485339" data-postid="4560" data-belowelement="comment-485339" data-respondelement="respond" data-replyto="Reply to Harish" aria-label='Reply to Harish'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-485346" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-485346" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 14, 2019 at 2:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-485346" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps assign the result to one variable and inspect it to see what you have?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-485346' data-commentid="485346" data-postid="4560" data-belowelement="comment-485346" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-489487" class="comment even thread-even depth-1">

	      	<div id="li-comment-489487" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7534f12f262adcbd0955eae6e5687a41?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7534f12f262adcbd0955eae6e5687a41?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Niclas H</span>
	                <span class="date">June 19, 2019 at 3:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-489487" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Question: Is only the hidden state forwarded to upper layers in LSTM, or is also the memory cell state forwarded to upper layers? </p>
<p>Or is the memory cell state only forwarded along the time sequence?<br />
Thank you!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489487' data-commentid="489487" data-postid="4560" data-belowelement="comment-489487" data-respondelement="respond" data-replyto="Reply to Niclas H" aria-label='Reply to Niclas H'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-489555" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-489555" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 20, 2019 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-489555" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Only the hidden state is output, memory state remains internal the node.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489555' data-commentid="489555" data-postid="4560" data-belowelement="comment-489555" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-490447" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-490447" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">QuantCub</span>
	                <span class="date">June 27, 2019 at 4:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-490447" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for sharing. I am not sure if I understand Keras.LSTM correctly. Could you please help me clarify / correct the following statements? </p>
<p>1. Keras LSTM is an output-to-hidden recurrent by default, e.g. it sends previous output to current hidden layers;<br />
2. To create a hidden-to-hidden LSTM, can we do:<br />
lstm1, state_h, state_c = LSTM(1, return_sequences=True, return_state=True)(inputs1)<br />
model = Model(inputs=(inputs1, state_h), outputs=lstm1)<br />
3. Does Keras train LSTM using teaching force or BPTT?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-490447' data-commentid="490447" data-postid="4560" data-belowelement="comment-490447" data-respondelement="respond" data-replyto="Reply to QuantCub" aria-label='Reply to QuantCub'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490493" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-490493" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 27, 2019 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-490493" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not sure I follow. The LSTM has outputs and hidden state.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-490493' data-commentid="490493" data-postid="4560" data-belowelement="comment-490493" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490598" class="comment even depth-3">

	      	<div id="li-comment-490598" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">QuantCub</span>
	                <span class="date">June 28, 2019 at 1:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-490598" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry for the confusion. My output-to-hidden refers to the 2nd of the three patterns in Goodfellow&#8217;s Deep Learning: Chapter 10<br />
&#8221;<br />
Some examples of important design patterns for recurrent neural networks include the following:<br />
 • Recurrent networks that produce an output at each time step and have recurrent connections between hidden units, illustrated in figure 10.3.<br />
• Recurrent networks that produce an output at each time step and have recurrent connections only from the output at one time step to the hidden units at the next time step, illustrated in figure 10.4<br />
• Recurrent networks with recurrent connections between hidden units, that read an entire sequence and then produce a single output, illustrated in figure 10.5.<br />
&#8220;</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-490598' data-commentid="490598" data-postid="4560" data-belowelement="comment-490598" data-respondelement="respond" data-replyto="Reply to QuantCub" aria-label='Reply to QuantCub'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490599" class="comment odd alt depth-4">

	      	<div id="li-comment-490599" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">QuantCub</span>
	                <span class="date">June 28, 2019 at 1:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-490599" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Back to me question:<br />
1. Keras LSTM is pattern 2 (previous output to current hidden) by default?<br />
2. Can we use return_state to create a pattern 1 (previous hidden to current hidden) model?<br />
3. Does Keras train LSTM using BPTT? or it can choose between teaching force and BPTT based on patterns?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-490599' data-commentid="490599" data-postid="4560" data-belowelement="comment-490599" data-respondelement="respond" data-replyto="Reply to QuantCub" aria-label='Reply to QuantCub'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490640" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-490640" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 28, 2019 at 6:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-490640" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you mean laterally within a layer, then no. If you across layers, then yes.</p>
<p>Yes, Keras supports a version of BPTT, more details here in general:<br />
<a href="https://machinelearningmastery.com/gentle-introduction-backpropagation-time/" rel="nofollow ugc">https://machinelearningmastery.com/gentle-introduction-backpropagation-time/</a></p>
<p>And here for Keras:<br />
<a href="https://machinelearningmastery.com/truncated-backpropagation-through-time-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/truncated-backpropagation-through-time-in-keras/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-490685" class="comment odd alt depth-5">

	      	<div id="li-comment-490685" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6db1f63c8d49ced7bd0e9333f67f6ac1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">QuantCub</span>
	                <span class="date">June 28, 2019 at 12:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-490685" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you, Jason!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-490888" class="comment even thread-even depth-1">

	      	<div id="li-comment-490888" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f110d9adad0885a6b63ac7e6e06cae12?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f110d9adad0885a6b63ac7e6e06cae12?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harshula</span>
	                <span class="date">June 29, 2019 at 7:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-490888" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason.<br />
I wanted to stack 2 GRUs. First one has hidden layers 64 and the second one 50 hidden layers<br />
I am unsure how to go about defining that.<br />
can you please help</p>
<p>encoder_inputs = Input(batch_shape=(32, 103, 1), name=&#8217;encoder_inputs&#8217;)</p>
<p>encoder_gru1 = GRU(64, return_sequences=True, return_state=True,name=&#8217;encoder_gru1&#8242;)<br />
encoder_out1, encoder_state1 = encoder_gru1(encoder_inputs)</p>
<p>encoder_gru2 = GRU(50, return_sequences=True, name=&#8217;encoder_gru&#8217;) encoder_out, encoder_state = encoder_gru2(encoder_out1)</p>
<p>decoder_gru = GRU(50, return_sequences=True, name=&#8217;decoder_gru&#8217;)<br />
decoder_out, decoder_state = decoder_gru(encoder_out)</p>
<p>However i get following error</p>
<p>  encoder_out, encoder_state = encoder_gru2(encoder_out1)</p>
<p>  File &#8220;C:\Users\Harshula\AppData\Roaming\Python\Python36\site-packages\tensorflow\python\framework\ops.py&#8221;, line 457, in __iter__<br />
    &#8220;Tensor objects are only iterable when eager execution is &#8221;</p>
<p>TypeError: Tensor objects are only iterable when eager execution is enabled. To iterate over this tensor use tf.map_fn.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-490888' data-commentid="490888" data-postid="4560" data-belowelement="comment-490888" data-respondelement="respond" data-replyto="Reply to Harshula" aria-label='Reply to Harshula'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490957" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-490957" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 30, 2019 at 9:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-490957" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can use this tutorial as a starting point and change the LSTMs to GRUs:<br />
<a href="https://machinelearningmastery.com/stacked-long-short-term-memory-networks/" rel="nofollow ugc">https://machinelearningmastery.com/stacked-long-short-term-memory-networks/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-490957' data-commentid="490957" data-postid="4560" data-belowelement="comment-490957" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491275" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-491275" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b7d998090e549c4ab71b268e4a1b3b3c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b7d998090e549c4ab71b268e4a1b3b3c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">sopa</span>
	                <span class="date">July 2, 2019 at 5:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-491275" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for these understandable article. I have a question, how to plot predictions. I mean when I apply sine wave to code to see three output of LSTM how can I plot outputs in the form of continues signal.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-491275' data-commentid="491275" data-postid="4560" data-belowelement="comment-491275" data-respondelement="respond" data-replyto="Reply to sopa" aria-label='Reply to sopa'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491346" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-491346" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 3, 2019 at 8:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-491346" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could use matplotlib and the plot() function.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-491346' data-commentid="491346" data-postid="4560" data-belowelement="comment-491346" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-492254" class="comment even thread-even depth-1">

	      	<div id="li-comment-492254" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b7d998090e549c4ab71b268e4a1b3b3c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b7d998090e549c4ab71b268e4a1b3b3c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">sopa</span>
	                <span class="date">July 9, 2019 at 4:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-492254" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I mean I want to plot lstm1, state_h, state_c. but when I write model.fit like that: </p>
<p>model.fit(trainX, trainY=[lstm1, state_h, state_c], epochs=10, batch_size=1, verbose=2)</p>
<p>I got this error:<br />
TypeError: Unrecognized keyword arguments: {&#8216;trainY&#8217;: [, array([[]],</p>
<p> dtype=object), array([],</p>
<p>  dtype=object)]} </p>
<p>should all of lsrm1, state_h, state_c have three dimension?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-492254' data-commentid="492254" data-postid="4560" data-belowelement="comment-492254" data-respondelement="respond" data-replyto="Reply to sopa" aria-label='Reply to sopa'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492333" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-492333" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 10, 2019 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-492333" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This looks really wrong, e.g. state variables as target variables in a call to fit.</p>
<p>What are you trying to achieve exactly?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-492333' data-commentid="492333" data-postid="4560" data-belowelement="comment-492333" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-492966" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-492966" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2849195f6b0408a838630ef97b2c592c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2849195f6b0408a838630ef97b2c592c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Leo</span>
	                <span class="date">July 15, 2019 at 8:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-492966" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>My code has three output of lstm : output, hidden_state, cell_state.</p>
<p>I want to see all of them.</p>
<p>lstm, h, c = LSTM(units=20, batch_input_shape=(1,10, 2), return_sequences=True, </p>
<p>return_state=True)(inp)</p>
<p>dense = Dense(2)(lstm)</p>
<p>model = Model(inputs=inp, outputs=dense )</p>
<p>I want to plot all three of my output. I can plot lstm but I can&#8217;t plot h_state and c_state.</p>
<p>How can I do that?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-492966' data-commentid="492966" data-postid="4560" data-belowelement="comment-492966" data-respondelement="respond" data-replyto="Reply to Leo" aria-label='Reply to Leo'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493018" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-493018" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 16, 2019 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-493018" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is odd.</p>
<p>Nevertheless, you could use matplotlib to plot anything you wish. e.g. plot(&#8230;)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-493018' data-commentid="493018" data-postid="4560" data-belowelement="comment-493018" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-495870" class="comment even thread-even depth-1">

	      	<div id="li-comment-495870" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6c86aa19fe9ee57bcf68fcf5186a37e8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c86aa19fe9ee57bcf68fcf5186a37e8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Youssef MELLAH</span>
	                <span class="date">August 7, 2019 at 8:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-495870" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, </p>
<p>Thank you for this good post.</p>
<p>I have two hidden states of two Bi-LSTM, H1 and H2, and i want to use them as inputs in two Dense layer. shoud i connect the two dense layers with the two Bi_LSTM and tha&#8217;s done? or connect them directly with the hidden states?</p>
<p>some thing like this : </p>
<p>hidden1 = Dense(100)(H1)<br />
hidden2 = Dense(100)(H2)  </p>
<p>thanks again!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-495870' data-commentid="495870" data-postid="4560" data-belowelement="comment-495870" data-respondelement="respond" data-replyto="Reply to Youssef MELLAH" aria-label='Reply to Youssef MELLAH'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-495913" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-495913" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 8, 2019 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-495913" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If by hidden states you mean those states that are internal to the LSTM layers, then I don&#8217;t think there is an effective way to pass them to a dense.</p>
<p>If you mean the outputs of the layer (the common meaning), then this looks fine.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-495913' data-commentid="495913" data-postid="4560" data-belowelement="comment-495913" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-495987" class="comment even depth-3">

	      	<div id="li-comment-495987" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6c86aa19fe9ee57bcf68fcf5186a37e8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c86aa19fe9ee57bcf68fcf5186a37e8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Youssef MELLAH</span>
	                <span class="date">August 8, 2019 at 7:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-495987" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>for being mor clear, i have two text inputs and i use embedding for encoding them, and i puted the output of embeddings into two Bi-LSTMs. </p>
<p>so i want to use the hidden states of the two Bi-LSTM to do predictions. The hidden state for the first input is returned as above :<br />
lstm, forward_h, forward_c, backward_h, backward_c= Bidirectional(..)(Embedding)<br />
and H1 is calculated as : H1 = Concatenate()([forward_h, backward_h]).</p>
<p>the same thing i did for the seconde input and i calculated H2.</p>
<p>mathematiccaly, how can i impliment the above formule : </p>
<p>softmax(V tanh(W1*H1 + W2*H2)) </p>
<p>which W and V  represent all trainable parameter matrices and vectors, respectively.</p>
<p>thank&#8217;s Jason for helping me.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-495987' data-commentid="495987" data-postid="4560" data-belowelement="comment-495987" data-respondelement="respond" data-replyto="Reply to Youssef MELLAH" aria-label='Reply to Youssef MELLAH'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496054" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-496054" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 9, 2019 at 8:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-496054" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work!</p>
<p>Looks like you want a weighted sum of the two vectors, perhaps a custom layer?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-496054' data-commentid="496054" data-postid="4560" data-belowelement="comment-496054" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496123" class="comment even depth-5">

	      	<div id="li-comment-496123" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6c86aa19fe9ee57bcf68fcf5186a37e8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c86aa19fe9ee57bcf68fcf5186a37e8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Youssef MELLAH</span>
	                <span class="date">August 9, 2019 at 6:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-496123" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>perhaps but to decrease complexity, i removed the two Bi-LSTM so i use the embeddings only for encoding.</p>
<p>so in order to do classification by using the 2 embeddings, can i use this mathematique formule:  softmax(V tanh(W1*E1 + W2*E2)) ? if so, the code above is correct to represente it?</p>
<p>input1 = Input(shape=(25,))<br />
E1 = Embedding(vocab_size, 100, input_length=25,<br />
                      weights=[embedding_matrix], trainable=False)(input1 )<br />
input1_hidden1 = Dense(100)(E1)</p>
<p>input2 = Input(shape=(25,))<br />
E2 = Embedding(vocab_size, 100, input_length=25,<br />
                      weights=[embedding_matrix], trainable=False)(input2 )<br />
input1_hidden2 = Dense(100)(E2 )</p>
<p>added = add([userQuestion_hidden1, tableShema_hidden1])<br />
added = Activation(&#8216;tanh&#8217;)(added)<br />
output1 = Dense(1, activation=&#8217;softmax&#8217;)(added)<br />
model = Model(inputs=[input1 , input2],outputs=output1)</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-496183" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-496183" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 10, 2019 at 7:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-496183" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m eager to help, but I don&#8217;t have the capacity to review/debug your code.</p>
<p>Perhaps try posting to the keras user group:<br />
<a href="https://machinelearningmastery.com/get-help-with-keras/" rel="nofollow ugc">https://machinelearningmastery.com/get-help-with-keras/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-496769" class="comment even depth-5">

	      	<div id="li-comment-496769" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6c86aa19fe9ee57bcf68fcf5186a37e8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c86aa19fe9ee57bcf68fcf5186a37e8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Youssef MELLAH</span>
	                <span class="date">August 15, 2019 at 12:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-496769" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>that&#8217;s interesting, thanks a lot Jason</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-496811" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-496811" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 15, 2019 at 8:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-496811" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-496899" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-496899" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/04c886467fa44931f594c0b429ec5f05?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/04c886467fa44931f594c0b429ec5f05?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dawjidda</span>
	                <span class="date">August 16, 2019 at 1:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-496899" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>please i have an error</p>
<p>TypeError: <code>GRU</code> can accept only 1 positional arguments (&#8216;units&#8217;,), but you passed the following positional arguments: [4, 200]</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-496899' data-commentid="496899" data-postid="4560" data-belowelement="comment-496899" data-respondelement="respond" data-replyto="Reply to Dawjidda" aria-label='Reply to Dawjidda'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496946" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-496946" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 16, 2019 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-496946" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this will help you to better understand the input shape:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-496946' data-commentid="496946" data-postid="4560" data-belowelement="comment-496946" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-503623" class="comment even thread-even depth-1">

	      	<div id="li-comment-503623" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5e8bce87635affefbfb88176513b30e1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5e8bce87635affefbfb88176513b30e1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Usman</span>
	                <span class="date">October 2, 2019 at 2:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-503623" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Amazing explanation!<br />
Just have one confusion.</p>
<p>In the very first example, where LSTM is defined as LSTM(1)(inputs1) and Input as Input(shape=(3,1)).</p>
<p>So, the way you have reshaped data (1,3,1) means the timesteps value is 3(middle value) and the no of cells in LSTM is 1 i.e., LSTM(1).</p>
<p>I am confused about how 1-LSTM is going to process 3 timestep value. I mean shouldn&#8217;t there be 3 neurons/LSTM(3) to process the (1,3,1) shape data? Or is the LSTM going to process each input one after the other in sequence?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-503623' data-commentid="503623" data-postid="4560" data-belowelement="comment-503623" data-respondelement="respond" data-replyto="Reply to Usman" aria-label='Reply to Usman'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503669" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-503669" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 2, 2019 at 8:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-503669" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>More on time steps vs samples vs features here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/what-is-the-difference-between-samples-timesteps-and-features-for-lstm-input</a></p>
<p>Number of LSTM units is unrelated to timesteps/features/samples.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-503669' data-commentid="503669" data-postid="4560" data-belowelement="comment-503669" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-528931" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-528931" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d08c1f1b78c1b7d71a7293fd90f57f0b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d08c1f1b78c1b7d71a7293fd90f57f0b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hugo</span>
	                <span class="date">April 9, 2020 at 4:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-528931" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perfectly clear. It was ver helpful to me.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-528931' data-commentid="528931" data-postid="4560" data-belowelement="comment-528931" data-respondelement="respond" data-replyto="Reply to Hugo" aria-label='Reply to Hugo'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-528988" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-528988" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 9, 2020 at 8:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-528988" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I&#8217;m happy to hear that!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-528988' data-commentid="528988" data-postid="4560" data-belowelement="comment-528988" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-534304" class="comment even thread-even depth-1">

	      	<div id="li-comment-534304" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2f4f86b9c07c87e49b3f971f24ac4b3b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2f4f86b9c07c87e49b3f971f24ac4b3b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nima</span>
	                <span class="date">May 12, 2020 at 1:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-534304" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, </p>
<p>Thanks for the clear discuss. I have a question about a little different implementation. I have a model with an lstm layer, where the hidden layer of the last time step will be passed to a softmax to create a sentiment. Is there any way that I could access the hidden states of this model when passing a new sequence to it?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-534304' data-commentid="534304" data-postid="4560" data-belowelement="comment-534304" data-respondelement="respond" data-replyto="Reply to Nima" aria-label='Reply to Nima'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-534359" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-534359" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 12, 2020 at 6:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-534359" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can define the model using the functional api to output the hidden state as a separate output of the model.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-534359' data-commentid="534359" data-postid="4560" data-belowelement="comment-534359" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-535269" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-535269" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3d88f10cccbe3719f1e4276a8f4f93d4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3d88f10cccbe3719f1e4276a8f4f93d4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nishchay Chawla</span>
	                <span class="date">May 18, 2020 at 8:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-535269" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br />
Thanks for the clear explanation. I am trying to make an encoder-decoder model, but this model will have two decoders(d1 and d2) and one encoder. One decoder(d1) gets input only from encoder while another one(d2) will get input from encoder and other decoder(d1). d2 must get hidden states from d1 only when d1 makes a particular type of prediction. Both decoders have a different set of vocabulary. Say d1 has &#8220;a,b,c,d&#8221; and d2 has &#8220;P,Q,R,S&#8221;. I want to pass a hidden state from d1 to d2 only when d1 predicts &#8220;b&#8221;.<br />
I hope this statement gives some sense of what I am trying to do. Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-535269' data-commentid="535269" data-postid="4560" data-belowelement="comment-535269" data-respondelement="respond" data-replyto="Reply to Nishchay Chawla" aria-label='Reply to Nishchay Chawla'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535334" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-535334" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 19, 2020 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-535334" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That sounds complex. Not sure what I can do for you, sorry. </p>
<p>Perhaps experiment with different prototypes until you achieve what you need?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-535334' data-commentid="535334" data-postid="4560" data-belowelement="comment-535334" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-563922" class="comment even thread-even depth-1">

	      	<div id="li-comment-563922" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b6e894664c2da3c51782f8050724c25f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b6e894664c2da3c51782f8050724c25f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Giri</span>
	                <span class="date">September 19, 2020 at 7:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-563922" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p> I usually visit your website lot of times for if i have any question. All your articles are so crisp and so is this return sequences and return state. No complex coding and point to point.  Thanks for the good work you are doing. </p>
<p>I have a question. If  in the above examples instead of LSTM(1), if we give LSTM(5) lets say.</p>
<p>inputs1 = Input(shape=(3, 1))<br />
lstm1 = LSTM(5, return_sequences=True)(inputs1)</p>
<p>Then my output will be a 3 D array. But i wonder how 5 hidden states at each time step are<br />
generated in LSTM. each LSTM has 1 hidden and 1 cell state right.</p>
<p>Can you please clarify my question?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-563922' data-commentid="563922" data-postid="4560" data-belowelement="comment-563922" data-respondelement="respond" data-replyto="Reply to Giri" aria-label='Reply to Giri'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-563984" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-563984" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 20, 2020 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/return-sequences-and-return-states-for-lstms-in-keras/#comment-563984" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, see this:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/how-is-data-processed-by-an-lstm" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/how-is-data-processed-by-an-lstm</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-563984' data-commentid="563984" data-postid="4560" data-belowelement="comment-563984" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/return-sequences-and-return-states-for-lstms-in-keras/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required='true' /><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required='true' /><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30" /><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment" /> <input type='hidden' name='comment_post_ID' value='4560' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="ba3e3d6f5e" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="16"/></p></form>	</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img alt='' src='https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=88&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=176&#038;d=mm&#038;r=g 2x' class='avatar avatar-88 photo' height='88' width='88' loading='lazy'/></span>
<p><strong>Welcome!</strong><br>
I'm <em>Jason Brownlee</em> PhD <br>
and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="/about">Read more</a></p>
<div class="fix"></div>
</div><div id="custom_html-89" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/12/small_icon_blue_linkedin3.png" alt="LinkedIn"></a>
&nbsp;&nbsp;&nbsp;
<a href="http://twitter.com/TeachTheMachine"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/12/small_icon_blue_twitter3.png" alt="Twitter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/12/small_icon_blue_facebook3.png" alt="Facebook"></a>
&nbsp;&nbsp;&nbsp;
<a href="/newsletter/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/12/small_icon_blue_email3.png" alt="Email Newsletter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/12/small_icon_blue_rss3.png" alt="RSS Feed"></a>
</div></div></div><div id="custom_html-49" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/"><img width="150" height="150" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/How-to-Reshape-Input-for-Long-Short-Term-Memory-Networks-in-Keras-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Reshape Input for Long Short-Term Memory Networks in Keras" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">How to Reshape Input Data for Long Short-Term Memory Networks in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/develop-encoder-decoder-model-sequence-sequence-prediction-keras/"><img width="150" height="150" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/How-to-Develop-an-Encoder-Decoder-Model-for-Sequence-to-Sequence-Prediction-in-Keras-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Develop an Encoder-Decoder Model for Sequence-to-Sequence Prediction in Keras" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/develop-encoder-decoder-model-sequence-sequence-prediction-keras/" rel="nofollow">How to Develop an Encoder-Decoder Model for Sequence-to-Sequence Prediction in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/encoder-decoder-attention-sequence-to-sequence-prediction-keras/"><img width="150" height="150" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Develop-an-Encoder-Decoder-Model-with-Attention-for-Sequence-to-Sequence-Prediction-in-Keras-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Develop an Encoder-Decoder Model with Attention for Sequence-to-Sequence Prediction in Keras" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/encoder-decoder-attention-sequence-to-sequence-prediction-keras/" rel="nofollow">How to Develop an Encoder-Decoder Model with Attention in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/timedistributed-layer-for-long-short-term-memory-networks-in-python/"><img width="150" height="150" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Use-the-TimeDistributed-Layer-for-Long-Short-Term-Memory-Networks-in-Python-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Use the TimeDistributed Layer for Long Short-Term Memory Networks in Python" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/timedistributed-layer-for-long-short-term-memory-networks-in-python/" rel="nofollow">How to Use the TimeDistributed Layer in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/lstm-autoencoders/"><img width="150" height="150" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/LSTM-Autoencoder-Model-With-Two-Decoders-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="LSTM Autoencoder Model With Two Decoders" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/lstm-autoencoders/" rel="nofollow">A Gentle Introduction to LSTM Autoencoders</a></div></div></div></div><div id="custom_html-17" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: center;">
	<p><h4>Loving the Tutorials?</h4></p>

<p>The <a href="/lstms-with-python/" rel="nofollow">LSTMs with Python</a> EBook is<br> where you'll find the <strong><i>Really Good</i></strong> stuff.</p>

<a href="/lstms-with-python/" class="woo-sc-button  red" ><span class="woo-">&gt;&gt; See What's Inside</span></a>

</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2020 Machine Learning Mastery Pty. Ltd. All Rights Reserved.<br />
Address: PO Box 206, Vermont Victoria 3133, Australia. | ACN: 626 223 336.<br />
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a> |
<a href="http://twitter.com/TeachTheMachine">Twitter</a> |
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> |
<a href="/newsletter/">Newsletter</a> |
<a href="/rss-feed/">RSS</a></p>		</div>

		<div id="credit" class="col-right">
			<p><a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a> |
<a href="/sitemap/">Sitemap</a> |
<a href="/site-search/">Search</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip -->
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=5.5.1' id='comment-reply-js'></script>
<script type='text/javascript' id='contact-form-7-js-extra'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"cached":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.2.2' id='contact-form-7-js'></script>
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/wp-last-modified-info/assets/js/frontend.min.js?ver=1.7.5' id='wplmi-frontend-js'></script>
<script type='text/javascript' id='q2w3_fixed_widget-js-extra'>
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"primary","margin_top":10,"margin_bottom":0,"stop_id":"","screen_max_width":400,"screen_max_height":0,"width_inherit":false,"refresh_interval":1500,"window_load_hook":false,"disable_mo_api":false,"widgets":["custom_html-89","custom_html-50","custom_html-90","custom_html-91","custom_html-58","custom_html-60","custom_html-59","custom_html-84","custom_html-51","custom_html-56","custom_html-55","custom_html-57","custom_html-53","custom_html-54","custom_html-52","custom_html-48","custom_html-49","custom_html-80","custom_html-47","custom_html-85","custom_html-30","custom_html-29","custom_html-28","custom_html-27","custom_html-3","custom_html-24","custom_html-23","custom_html-22","custom_html-21","custom_html-20","custom_html-19","custom_html-18","custom_html-17","custom_html-16","custom_html-15","custom_html-14","custom_html-13","custom_html-11","custom_html-10","custom_html-5","custom_html-9","custom_html-61","custom_html-81","custom_html-86"]}];
/* ]]> */
</script>
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/q2w3-fixed-widget/js/q2w3-fixed-widget.min.js?ver=5.1.9' id='q2w3_fixed_widget-js'></script>
<script type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=5.5.1' id='wp-embed-js'></script>
<script async="async" type='text/javascript' src='https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1.6' id='akismet-form-js'></script>
<script type='text/javascript'>function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script></body>
</html>